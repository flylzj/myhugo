---
title: "<text>来自网络共享驱动器的数据</text>"
date: 2023-05-15T17:17:15+08:00
draft: false
---
## <text>来自网络共享驱动器的数据</text>
攻击者可能会搜索他们入侵的计算机上的网络共享，以查找感兴趣的文件。通过从当前系统可以访问的共享网络驱动器（主机共享目录、网络文件服务器等）收集远程系统的敏感数据，然后再进行信息窃取。可能会使用交互式命令行，以及在 cmd 中的常见功能来收集信息。
### 操作示例

|ID|名称|描述|
|----|----|----|
|[G0007]()|APT28|APT28已从网络共享驱动器收集了文件。[1]|
|[S0128]()|BADNEWS|BADNEWS首次启动时，会扫描受害者的网络驱动器，并收集拥有以下后缀名的文档：.doc，.docx，.pdf，.ppt，.pptx和.txt。[2]|
|[G0060]()|BRONZE BUTLER|BRONZE BUTLER已经从文件共享中窃取并外传文件。[3]|
|[C0015]()|C0015|在C0015期间，攻击者在网络加密之前从网络共享驱动器中收集了文件。[4]|
|[G0114]()|Chimera|Chimera从网络共享中收集了有价值的数据。[5]|
|[S0050]()|CosmicDuke|CosmicDuke通过匹配预定义列表中的文件扩展名和关键字，从网络共享驱动器中窃取用户文件。[6]|
|[S0554]()|Egregor|Egregor可以在枚举驱动程序时收集任何发现的文件，然后将其发送到其C2通道。[7]|
|[G0117]()|Fox Kitten|Fox Kitten已经搜索了网络共享来访问敏感文件。|
|[G0047]()|Gamaredon Group|Gamaredon Group恶意软件已从映射的网络驱动器中收集了Microsoft Office文档。[9]|
|[G0045]()|menuPass|menuPass利用net use挂载网络共享，并使用Robocopy工具来传输数据，从远程系统中收集数据。[10]|
|[S0458]()|Ramsay|Ramsay可以从网络驱动器中收集数据，并为其外传做好准备。[11]|
|[G0054]()|Sowbug|Sowbug从受害网络的文件服务器中提取了Word文档。[12]|

### 缓解措施
这种攻击技术很难通过预防性控制来缓解，因为它是基于滥用系统功能的。
### 检测

|  ID   | 数据源  | 数据组件|检测|
|  ----  | ----  |----|----|
|[DS0017]()|Command|Command Execution|监控执行的命令和参数，以便收集网络共享中的文件所采取的行动。具有内置功能的远程访问工具可以直接与Windows API交互，以收集并复制到指定位置。数据也可以通过Windows系统管理工具（例如Windows管理工具和PowerShell）获取和分配。|
|[DS0022]()|File|File Access|监控与网络共享交互的意料之外的文件（例如 .pdf， .docx，.jpg 等等）。|
|[DS0033]()|Network Share|Network Share Access|对网络共享的未预期和异常访问进行监控。|
|[DS0029]()|Network Traffic|Network Connection Creation|监控新建立的网络连接，这些连接可能会在攻击者已经入侵的计算机上搜索网络共享，以查找感兴趣的文件。|
|[]()||Network Traffic Content|监视和分析与不符合预期协议标准和流量流程有关的协议的流量模式和数据包检查（例如，与已建立的流不一致的无关数据包、无意义或异常的流量模式、异常的语法或结构）。考虑与进程监视和命令行相关联，以检测与流量模式相关的异常进程执行和命令行参数（例如，监测文件使用中不通常启动协议的连接的异常情况）。|

