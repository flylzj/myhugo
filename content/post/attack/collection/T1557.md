---
title: "中间人攻击"
date: 2023-05-14T20:38:48+08:00
draft: false
---



## 中间人攻击(T1557)


攻击者可能会尝试使用中间人攻击（AiTM）技术，将自己置于两个或多个网络设备之间，以支持后续行为，如网络嗅探(T1040)或传输数据篡改(T1565-002)。
通过滥用常见网络协议的功能（例如ARP、DNS、LLMNR等），攻击者可能会强制设备通过攻击者控制的系统进行通信，以便收集信息或执行其他操作。[](#1)

例如，攻击者可能操纵受害者的DNS设置，以便进行其他恶意活动，如防止/重定向用户访问合法网站并且/或者推送其他恶意软件。(#2)(#3)(#4)
攻击者还可以操纵DNS并利用其位置拦截用户凭据和会话Cookie。
降级攻击也可以用于建立AiTM位置，例如通过协商通信协议（SSL/TLS）或加密算法的较低安全性、废弃版本或较弱版本。

攻击者也可能利用AiTM的位置来尝试监视和/或修改流量，例如在传输数据篡改中。攻击者可以设置类似于AiTM的位置，以防止流量流向适当的目标，潜在的削弱防御和/或支持网络拒绝服务攻击。

### 操作示例(Procedure Examples)

|  ID   | 名称  | 描述|
|  ----  | ----  |----|
| [S0281]()  |  Dok| Dok代理web流量，潜在的监视和更改受害者的HTTP（S）流量。|
| [G0094]()  | 	Kimsuky |Kimsuky使用修改版的PHProxy来测试受害者和被访问网站之间的网络流量。|

### 缓解措施（Mitigations）

|  ID   | 缓解措施  | 描述|
|  ----  | ----  |----|
| [M1042]()  |  禁用或删除功能或程序（Disable or Remove Feature or Program）| 如果适用的话，禁用可能被用来拦截网络流量的传统网络协议，特别是那些在环境中不需要的协议。|
| [M1041]()  | 	加密敏感信息（Encrypt Sensitive Information） |确保所有有线和/或无线流量都得到适当的加密。使用最佳实践进行身份验证协议，例如Kerberos，并确保可能包含凭据的Web流量受到SSL/TLS的保护。|
|[M1037]()|过滤网络流量|使用网络设备和基于主机的安全软件来阻止不必要的网络流量，例如可能被利用于AiTM条件的旧协议。|
|[M1035]()|限制网络资源访问|限制对可以被用于重塑流量或者产生AiTM条件的网络基础设施和资源的访问。|
|[M1031]()|网络入侵防范|能够识别表明AiTM活动的流量模式的网络入侵检测和预防系统可用于缓解网络层面的活动。|
|[M1030]()|网络分段（网段）|网络分割可用于隔离不需要广泛网络访问的基础设施组件。这可以减轻AiTM活动的范围。|
|[M1017()]|人员培训|培训用户对证书错误保持怀疑，攻击者可能使用他们自己的证书来尝试拦截HTTPS流量。当应用程序的证书与主机所期望的证书不一致时，可能会出现证书错误。|

### 检测

|  ID   | 数据源  | 数据组件|检测|
|  ----  | ----  |----|----|
| [DS0015]()  |应用程序日志| 应用程序日志内容|监控应用程序日志，以检测与网络协议和其他常被滥用于AiTM的服务相关的设置更改和其他事件。|
| [DS0029]()  |网络流量|网络流量内容|监控网络流量，以检测与已知AiTM行为相关的异常情况。|
|[DS0029]()|网络流量|网络流量流|监控来自未知/意外硬件设备的网络流量。本地网络流量元数据（例如源MAC地址）以及使用DHCP等网络管理协议可能有助于识别硬件。|
|[DS0019]()|服务|服务创建|通过Windows事件日志监控新构建的服务/守护程序，关注事件ID 4697和7045。数据和事件不应孤立地看待，而是作为一系列行为链的一部分来考虑，这可能会导致其他活动，例如远程登录或进程创建事件。|
|[DS0024]()|Windows注册表|Windows注册表键修改|监视 HKLM\Software\Policies\Microsoft\Windows NT\DNSClient 的更改，以查看“EnableMulticast”DWORD值。 值为“0”表示已禁用LLMNR。|

### 子技术

|  ID   | 名称  |
|  ----  | ----  |
| [T1557.001](#中间人攻击llmnrnbt-ns中毒和smb中继)  | 链路本地多播名称解析(Link-Local Multicast Name Resolution)/网络基本输入输出系统-命名服务(Network Basic Input/Output System-Name Service) |
| [T1557.002](#中间人攻击arp缓存中毒)  | 地址解析协议缓存中毒(ARP Cache Poisoning) |
| [T1557.003](#中间人攻击dhcp欺骗)| 动态主机配置协议欺骗(DHCP Spoofing)|

