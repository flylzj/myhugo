---
title: "中间人攻击：ARP缓存中毒"
date: 2023-05-14T20:38:48+08:00
draft: false
---

## 中间人攻击：ARP缓存中毒

攻击者可能会毒化地址解析协议（ARP）缓存，以便将自己置于两个或多个网络设备之间的通信中。这种活动可能被用来启用后续行为，例如网络嗅探或传输数据篡改。

ARP协议用于将IPv4地址解析为链路层地址，例如媒体访问控制（MAC）地址。局域网段中的设备通过使用链路层地址相互通信。如果网络设备没有特定网络设备的链路层地址，则可能向本地网络发送广播ARP请求以将IP地址转换为MAC地址。关联IP地址的设备直接回复其MAC地址。发出ARP请求的网络设备随后将在其ARP缓存中使用并存储该信息。

攻击者可能会被动等待ARP请求，以毒化请求设备的ARP缓存。攻击者可以回复他们的MAC地址，从而欺骗受害者使其相信自己正在与预期的网络设备通信。为了毒化ARP缓存，攻击者的回复必须比合法IP地址所有者更快。攻击者还可能发送一个无回报的ARP回复（没有arp请求的回复），向本地网段的所有设备恶意宣布一个特定IP地址的所有权。

ARP协议是无状态的，不需要进行身份验证。因此，设备可能会错误地将MAC地址添加或更新到其ARP缓存中。

攻击者可能会利用ARP缓存中毒作为拦截网络流量的手段。这种活动可以用来收集和/或中继数据，例如凭据，特别是那些通过不安全、未加密协议发送的数据。

### 操作示例

|  ID   | 名称  | 描述|
|  ----  | ----  |----|
| [G0003]()  |  Cleaver| Cleaver使用了定制工具来促进ARP缓存中毒。|
| [G1014]()  | 		LuminousMoth |LuminousMoth使用ARP欺骗将被攻击的机器重定向到一个由攻击者控制的网站。|


### 缓解措施


|  ID   | 缓解措施  | 描述|
|  ----  | ----  |----|
| [M1042]()  |  禁用或删除功能或程序（Disable or Remove Feature or Program）|考虑禁用在收到无回报ARP时更新ARP缓存。|
| [M1041]()  | 	加密敏感信息（Encrypt Sensitive Information） |确保所有有线和/或无线流量都得到适当的加密。使用最佳实践进行身份验证协议，例如Kerberos，并确保可能包含凭据的Web流量受到SSL/TLS的保护。|
|[M1037]()|过滤网络流量|请考虑在交换机上启用DHCP Snooping和Dynamic ARP Inspection，以创建通过DHCP请求的IP地址与ARP表之间的映射，并将这些值绑定到交换机上的端口，从而可以阻止伪造流量。|
|[M1035]()|限制网络资源访问|为网络设备创建静态ARP条目。对于大型网络，实施静态ARP条目可能不可行。|
|[M1031]()|网络入侵防范|能够识别表明AiTM活动的流量模式的网络入侵检测和预防系统可用于缓解网络层面的活动。|
|[M1017()]|人员培训|培训用户对证书错误保持怀疑，攻击者可能使用他们自己的证书来尝试拦截HTTPS流量。当应用程序的证书与主机所期望的证书不一致时，可能会出现证书错误。|

### 检测

|  ID   | 缓解措施  | 描述|
|  ----  | ----  |----|
| [DS0029]()  |网络流量|网络流量内容|监控网络流量，注意异常的ARP流量，特别是不必要的ARP响应可能会引起怀疑。考虑收集端点上ARP缓存的变化情况以检测ARP欺骗攻击。例如，如果多个IP地址映射到单个MAC地址，则可能表明ARP缓存已被篡改。|
|[DS0029]()|网络流量|网络流量流|监控来自未知/意外硬件设备的网络流量。本地网络流量元数据（例如源MAC地址）以及使用DHCP等网络管理协议可能有助于识别硬件。|