---
title: "数据分阶段：
远程数据分阶段。"
date: 2023-05-15T17:17:34+08:00
draft: false
---
## 数据分阶段：
远程数据分阶段。
攻击者可能会将从多个系统收集的数据存储在一个系统上的中央位置或目录中，然后才将其外泄。数据可能存储在单独的文件中，也可能通过归档已收集的数据等技术合并为一个文件。攻击者可能使用交互式命令行壳，并使用cmd和bash中的常见功能将数据复制到分段位置。在云环境中，攻击者可能会在特定的实例或虚拟机内分段数据，然后再将其外泄。攻击者可以在外泄之前将数据分段到一个系统上，这样可以最小化与他们的C2服务器之间的连接数量，更好地逃避检测。
### 操作示例

|ID|名称|描述|
|----|----|----|
|[G0007]()|APT28|APT28曾经在受攻击目标的Outlook Web Access(OWA)服务器上布置了存储所收集数据的归档文件。[2]|
|[S1043]()|ccf32|<text>ccf32已将文件复制到一台感染了Chinoxy或其他后门的远程机器上。[3]</text>|
|[G0114]()|Chimera|Chimera将窃取的数据存放在目标环境中的指定服务器上。[4]|
|[G0037]()|FIN6|FIN6的攻击者压缩了来自远程系统的数据，并在数据外泄之前将其移动到另一个暂存系统。[5]|
|[G0061]()|FIN8|FIN8会将网络中分阶段的数据聚合到一个单一的位置。[6]|
|[G0065]()|Leviathan|Leviathan在数据外泄之前远程上场了。[7]|
|[G0045]()|menuPass|menuPass在向外传输资料前，将数据留存在远程MSP系统或其他受害网络中。[8][9]|
|[C0002]()|Night Dragon|在“夜龙行动”期间，威胁行为者将文件复制到公司的Web服务器上，随后下载了这些文件。[10]|
|[C0024]()|SolarWinds Compromise|在SolarWinds遭遇攻击事件期间，APT29将数据和文件制作成密码保护的归档文件，蓄意存储在受害者的OWA服务器上。|
|[G0027]()|Threat Group-3390|威胁组3390将经过加密的存档文件移动到先前已经被攻击者利用过的面向互联网的服务器，然后再将这些存档文件外传。这些服务器在遭受攻击之前就已经被植入了China Chopper木马。|

### 缓解措施
这种攻击技术基于滥用系统功能，因此很难通过预防措施来轻易地缓解。
### 检测

|  ID   | 数据源  | 数据组件|检测|
|  ----  | ----  |----|----|
|[DS0017]()|Command|Command Execution|监视已执行的命令和参数来寻找可能被用于收集和组合文件的行动。带有内置功能的远程访问工具可能会直接与Windows API 交互，以收集并复制到指定位置。数据也可以通过Windows系统管理工具（如Windows管理工具和PowerShell）获取和准备。|
|[DS0022]()|File|File Access|监视那些从不同位置读取文件并将它们写入同一目录或文件的进程可能是数据准备阶段的迹象，特别是如果怀疑它们对文件执行了加密或压缩操作，例如7zip、RAR、ZIP或zlib。|
|[]()||File Creation|监控所有公共可写目录、中央位置以及常用的暂存目录（回收站、临时文件夹等），以定期检查可能表明进行二次攻击的压缩或加密数据。|

