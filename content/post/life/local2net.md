---
title: "废弃笔记本利用计划（一）：使用zerotier one打通内外网"
showDate: true
date: 2022-01-04T15:20:27+08:00
draft: false
---

## 0x00 起因

之前买了台Oculus quest2玩，但是因为是fb家的，所以需要连外网才能玩，但是就想着用闲置的小米路由器刷个`openwrt`，结果操作失误路由器变砖了。

后来朋友推荐刷软路由，刚好我有台吃灰的笔记本，于是就开始了折腾之路。刷上了`koolshare`改的`lede`之后，简直打开了我对路由器的大门，原来路由器还有这么多花里胡哨的功能。酷软里的`frps`客户端和`docker`配合，再连一台公网服务器，岂不是就相当于拥有一台内网服务器。

恰好双十一入了三年的腾讯云8M带宽的服务器，正好可以拿来当作内网服务器的出口。

## 0x01 简单调研

稍微看了一下主流的几种内外网连通的方案`frp`，`DDNS`, `zerotier one`

`frp`需要配置端口映射，而且只能通过公网来访问

`DDNS`需要公网ip，搜了下流程，还是算了

最终选定了`zerotier one`，跨网创建虚拟装用网络，pc，移动端都可以加入，这样既可以通过虚拟网络访问，也可以把内网服务器服务转发到公网服务器让没有加入`zerotier`的设备访问

## 0x02 ocker-compose一键搭建

已经有人做好了zeroiter planet的[docker-compose.yaml](https://gitee.com/Jonnyan404/zerotier-planet)，在公网服务器建好之后，创建一个network，然后在各种设备（pc，Android，ipad）安装zerotier的官方应用，效果如图，所有的设备现在都在一个内网了。

![1](./1.png)

下一步就是在内网服务器搭建一些服务，然后让它们或通过内网被访问，或通过转发到公网服务器被访问。